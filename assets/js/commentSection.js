(()=>{const e=document.getElementById("videoContainer"),t=document.getElementById("commentForm"),n=document.querySelector(".video__comment"),a=document.querySelector(".video__delete");t&&(t.addEventListener("submit",(async n=>{n.preventDefault();const a=t.querySelector("textarea"),o=a.value,c=e.dataset.id;if(""===o)return;const d=await fetch(`/api/videos/${c}/comment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:o})});if(201===d.status){a.value="";const{newCommentId:e}=await d.json();((e,t)=>{const n=document.querySelector(".video__comments ul"),a=document.createElement("li");a.dataset.id=t,a.className="video__comment";const o=document.createElement("i");o.classList="fas fa-comment";const c=document.createElement("span");c.innerText=` ${e}`;const d=document.createElement("span");d.innerText="  ❌",d.className="video__delete",a.appendChild(o),a.appendChild(c),a.appendChild(d),n.prepend(a)})(o,e)}})),a.addEventListener("click",(async e=>{const t=n.dataset.id;201===(await fetch(`/api/comments/${t}/delete`,{method:"DELETE"})).status&&e.target.parentElement.remove()})))})();